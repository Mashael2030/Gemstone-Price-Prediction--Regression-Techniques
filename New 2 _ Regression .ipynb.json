{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "12edbb3a",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import statsmodels.api as sm\n",
    "import statsmodels.formula.api as smf\n",
    "import patsy\n",
    "import seaborn as sns\n",
    "import matplotlib.pyplot as plt\n",
    "from datetime import date\n",
    "from sklearn import linear_model\n",
    "from sklearn.metrics import mean_squared_error, r2_score\n",
    "from sklearn.linear_model import LinearRegression\n",
    "from sklearn.linear_model import RidgeCV\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.linear_model import LinearRegression, Ridge #ordinary linear regression + w/ ridge regularization\n",
    "from sklearn.preprocessing import StandardScaler, PolynomialFeatures"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "cb88aad1",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/opt/anaconda3/lib/python3.8/site-packages/IPython/core/interactiveshell.py:3165: DtypeWarning: Columns (6) have mixed types.Specify dtype option on import or set low_memory=False.\n",
      "  has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>VendorID</th>\n",
       "      <th>tpep_pickup_datetime</th>\n",
       "      <th>tpep_dropoff_datetime</th>\n",
       "      <th>passenger_count</th>\n",
       "      <th>trip_distance</th>\n",
       "      <th>RatecodeID</th>\n",
       "      <th>store_and_fwd_flag</th>\n",
       "      <th>PULocationID</th>\n",
       "      <th>DOLocationID</th>\n",
       "      <th>payment_type</th>\n",
       "      <th>fare_amount</th>\n",
       "      <th>extra</th>\n",
       "      <th>mta_tax</th>\n",
       "      <th>tip_amount</th>\n",
       "      <th>tolls_amount</th>\n",
       "      <th>improvement_surcharge</th>\n",
       "      <th>total_amount</th>\n",
       "      <th>congestion_surcharge</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2.0</td>\n",
       "      <td>2021-03-01 00:22:02</td>\n",
       "      <td>2021-03-01 00:23:22</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.0</td>\n",
       "      <td>N</td>\n",
       "      <td>264</td>\n",
       "      <td>264</td>\n",
       "      <td>2.0</td>\n",
       "      <td>3.00</td>\n",
       "      <td>0.50</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.3</td>\n",
       "      <td>4.30</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2.0</td>\n",
       "      <td>2021-03-01 00:24:48</td>\n",
       "      <td>2021-03-01 00:24:56</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.0</td>\n",
       "      <td>N</td>\n",
       "      <td>152</td>\n",
       "      <td>152</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.50</td>\n",
       "      <td>0.50</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.3</td>\n",
       "      <td>3.80</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2.0</td>\n",
       "      <td>2021-03-01 00:25:17</td>\n",
       "      <td>2021-03-01 00:31:01</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.0</td>\n",
       "      <td>N</td>\n",
       "      <td>152</td>\n",
       "      <td>152</td>\n",
       "      <td>2.0</td>\n",
       "      <td>3.50</td>\n",
       "      <td>0.50</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.3</td>\n",
       "      <td>4.80</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1.0</td>\n",
       "      <td>2021-03-01 00:07:40</td>\n",
       "      <td>2021-03-01 00:31:23</td>\n",
       "      <td>0.0</td>\n",
       "      <td>16.50</td>\n",
       "      <td>4.0</td>\n",
       "      <td>N</td>\n",
       "      <td>138</td>\n",
       "      <td>265</td>\n",
       "      <td>1.0</td>\n",
       "      <td>51.00</td>\n",
       "      <td>0.50</td>\n",
       "      <td>0.5</td>\n",
       "      <td>11.65</td>\n",
       "      <td>6.12</td>\n",
       "      <td>0.3</td>\n",
       "      <td>70.07</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2.0</td>\n",
       "      <td>2021-03-01 00:02:13</td>\n",
       "      <td>2021-03-01 00:06:01</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.13</td>\n",
       "      <td>1.0</td>\n",
       "      <td>N</td>\n",
       "      <td>68</td>\n",
       "      <td>264</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5.50</td>\n",
       "      <td>0.50</td>\n",
       "      <td>0.5</td>\n",
       "      <td>1.86</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.3</td>\n",
       "      <td>11.16</td>\n",
       "      <td>2.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1925147</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2021-03-29 12:39:29</td>\n",
       "      <td>2021-03-29 13:06:30</td>\n",
       "      <td>NaN</td>\n",
       "      <td>13.18</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>135</td>\n",
       "      <td>75</td>\n",
       "      <td>NaN</td>\n",
       "      <td>34.76</td>\n",
       "      <td>2.75</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.00</td>\n",
       "      <td>6.12</td>\n",
       "      <td>0.3</td>\n",
       "      <td>44.43</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1925148</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2021-03-29 12:11:00</td>\n",
       "      <td>2021-03-29 12:28:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.60</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>107</td>\n",
       "      <td>163</td>\n",
       "      <td>NaN</td>\n",
       "      <td>18.34</td>\n",
       "      <td>2.75</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.3</td>\n",
       "      <td>21.89</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1925149</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2021-03-29 12:50:00</td>\n",
       "      <td>2021-03-29 13:14:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5.50</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>137</td>\n",
       "      <td>17</td>\n",
       "      <td>NaN</td>\n",
       "      <td>37.76</td>\n",
       "      <td>2.75</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.3</td>\n",
       "      <td>41.31</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1925150</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2021-03-29 12:12:00</td>\n",
       "      <td>2021-03-29 12:32:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.78</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>177</td>\n",
       "      <td>85</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.55</td>\n",
       "      <td>2.75</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.00</td>\n",
       "      <td>23.50</td>\n",
       "      <td>0.3</td>\n",
       "      <td>25.50</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1925151</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2021-03-29 12:31:00</td>\n",
       "      <td>2021-03-29 13:03:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>11.46</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>216</td>\n",
       "      <td>217</td>\n",
       "      <td>NaN</td>\n",
       "      <td>48.85</td>\n",
       "      <td>2.75</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.3</td>\n",
       "      <td>52.40</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1925152 rows × 18 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         VendorID tpep_pickup_datetime tpep_dropoff_datetime  passenger_count  \\\n",
       "0             2.0  2021-03-01 00:22:02   2021-03-01 00:23:22              1.0   \n",
       "1             2.0  2021-03-01 00:24:48   2021-03-01 00:24:56              1.0   \n",
       "2             2.0  2021-03-01 00:25:17   2021-03-01 00:31:01              1.0   \n",
       "3             1.0  2021-03-01 00:07:40   2021-03-01 00:31:23              0.0   \n",
       "4             2.0  2021-03-01 00:02:13   2021-03-01 00:06:01              1.0   \n",
       "...           ...                  ...                   ...              ...   \n",
       "1925147       NaN  2021-03-29 12:39:29   2021-03-29 13:06:30              NaN   \n",
       "1925148       NaN  2021-03-29 12:11:00   2021-03-29 12:28:00              NaN   \n",
       "1925149       NaN  2021-03-29 12:50:00   2021-03-29 13:14:00              NaN   \n",
       "1925150       NaN  2021-03-29 12:12:00   2021-03-29 12:32:00              NaN   \n",
       "1925151       NaN  2021-03-29 12:31:00   2021-03-29 13:03:00              NaN   \n",
       "\n",
       "         trip_distance  RatecodeID store_and_fwd_flag  PULocationID  \\\n",
       "0                 0.00         1.0                  N           264   \n",
       "1                 0.00         1.0                  N           152   \n",
       "2                 0.00         1.0                  N           152   \n",
       "3                16.50         4.0                  N           138   \n",
       "4                 1.13         1.0                  N            68   \n",
       "...                ...         ...                ...           ...   \n",
       "1925147          13.18         NaN                NaN           135   \n",
       "1925148           2.60         NaN                NaN           107   \n",
       "1925149           5.50         NaN                NaN           137   \n",
       "1925150           3.78         NaN                NaN           177   \n",
       "1925151          11.46         NaN                NaN           216   \n",
       "\n",
       "         DOLocationID  payment_type  fare_amount  extra  mta_tax  tip_amount  \\\n",
       "0                 264           2.0         3.00   0.50      0.5        0.00   \n",
       "1                 152           2.0         2.50   0.50      0.5        0.00   \n",
       "2                 152           2.0         3.50   0.50      0.5        0.00   \n",
       "3                 265           1.0        51.00   0.50      0.5       11.65   \n",
       "4                 264           1.0         5.50   0.50      0.5        1.86   \n",
       "...               ...           ...          ...    ...      ...         ...   \n",
       "1925147            75           NaN        34.76   2.75      0.5        0.00   \n",
       "1925148           163           NaN        18.34   2.75      0.5        0.00   \n",
       "1925149            17           NaN        37.76   2.75      0.5        0.00   \n",
       "1925150            85           NaN        -1.55   2.75      0.5        0.00   \n",
       "1925151           217           NaN        48.85   2.75      0.5        0.00   \n",
       "\n",
       "         tolls_amount  improvement_surcharge  total_amount  \\\n",
       "0                0.00                    0.3          4.30   \n",
       "1                0.00                    0.3          3.80   \n",
       "2                0.00                    0.3          4.80   \n",
       "3                6.12                    0.3         70.07   \n",
       "4                0.00                    0.3         11.16   \n",
       "...               ...                    ...           ...   \n",
       "1925147          6.12                    0.3         44.43   \n",
       "1925148          0.00                    0.3         21.89   \n",
       "1925149          0.00                    0.3         41.31   \n",
       "1925150         23.50                    0.3         25.50   \n",
       "1925151          0.00                    0.3         52.40   \n",
       "\n",
       "         congestion_surcharge  \n",
       "0                         0.0  \n",
       "1                         0.0  \n",
       "2                         0.0  \n",
       "3                         0.0  \n",
       "4                         2.5  \n",
       "...                       ...  \n",
       "1925147                   0.0  \n",
       "1925148                   0.0  \n",
       "1925149                   0.0  \n",
       "1925150                   0.0  \n",
       "1925151                   0.0  \n",
       "\n",
       "[1925152 rows x 18 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = pd.read_csv('/Users/Ajwad/Desktop/NBM_Regression_Gamma/yellow_tripdata_2021-03.csv') # Load tha dataset\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "8b2f61a6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(1925152, 18)"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "4a7411da",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 1925152 entries, 0 to 1925151\n",
      "Data columns (total 18 columns):\n",
      " #   Column                 Dtype  \n",
      "---  ------                 -----  \n",
      " 0   VendorID               float64\n",
      " 1   tpep_pickup_datetime   object \n",
      " 2   tpep_dropoff_datetime  object \n",
      " 3   passenger_count        float64\n",
      " 4   trip_distance          float64\n",
      " 5   RatecodeID             float64\n",
      " 6   store_and_fwd_flag     object \n",
      " 7   PULocationID           int64  \n",
      " 8   DOLocationID           int64  \n",
      " 9   payment_type           float64\n",
      " 10  fare_amount            float64\n",
      " 11  extra                  float64\n",
      " 12  mta_tax                float64\n",
      " 13  tip_amount             float64\n",
      " 14  tolls_amount           float64\n",
      " 15  improvement_surcharge  float64\n",
      " 16  total_amount           float64\n",
      " 17  congestion_surcharge   float64\n",
      "dtypes: float64(13), int64(2), object(3)\n",
      "memory usage: 264.4+ MB\n"
     ]
    }
   ],
   "source": [
    "df.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "dba4497f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "VendorID                 float64\n",
       "tpep_pickup_datetime      object\n",
       "tpep_dropoff_datetime     object\n",
       "passenger_count          float64\n",
       "trip_distance            float64\n",
       "RatecodeID               float64\n",
       "store_and_fwd_flag        object\n",
       "PULocationID               int64\n",
       "DOLocationID               int64\n",
       "payment_type             float64\n",
       "fare_amount              float64\n",
       "extra                    float64\n",
       "mta_tax                  float64\n",
       "tip_amount               float64\n",
       "tolls_amount             float64\n",
       "improvement_surcharge    float64\n",
       "total_amount             float64\n",
       "congestion_surcharge     float64\n",
       "dtype: object"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "d8d5b90f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#-----------------------------"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "c9eb252d",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_train , df_test = train_test_split(df , test_size=.2, random_state=10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "6fa8c6a4",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_train, df_val = train_test_split(df_train, test_size=.25, random_state=5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "d0f4f005",
   "metadata": {},
   "outputs": [],
   "source": [
    "#------- clean train "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "1c1c8fce",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(1155090, 18)"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_train.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "b8368b9b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Missing values</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>VendorID</th>\n",
       "      <td>76724</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>tpep_pickup_datetime</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>tpep_dropoff_datetime</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>passenger_count</th>\n",
       "      <td>76724</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>trip_distance</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>RatecodeID</th>\n",
       "      <td>76724</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>store_and_fwd_flag</th>\n",
       "      <td>76724</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PULocationID</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>DOLocationID</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>payment_type</th>\n",
       "      <td>76724</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fare_amount</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>extra</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mta_tax</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>tip_amount</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>tolls_amount</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>improvement_surcharge</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>total_amount</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>congestion_surcharge</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                       Missing values\n",
       "VendorID                        76724\n",
       "tpep_pickup_datetime                0\n",
       "tpep_dropoff_datetime               0\n",
       "passenger_count                 76724\n",
       "trip_distance                       0\n",
       "RatecodeID                      76724\n",
       "store_and_fwd_flag              76724\n",
       "PULocationID                        0\n",
       "DOLocationID                        0\n",
       "payment_type                    76724\n",
       "fare_amount                         0\n",
       "extra                               0\n",
       "mta_tax                             0\n",
       "tip_amount                          0\n",
       "tolls_amount                        0\n",
       "improvement_surcharge               0\n",
       "total_amount                        0\n",
       "congestion_surcharge                0"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nulls = df_train.isnull().sum().to_frame()# (to_frame():Convert Series to DataFrame),(sum():To sum the number of missing values),(isnull()to detect missing values)\n",
    "nulls.columns = [\"Missing values\"] \n",
    "nulls"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "6cd96396",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_train = df_train.dropna(how ='any')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "17294f1c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Missing values</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>VendorID</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>tpep_pickup_datetime</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>tpep_dropoff_datetime</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>passenger_count</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>trip_distance</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>RatecodeID</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>store_and_fwd_flag</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PULocationID</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>DOLocationID</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>payment_type</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fare_amount</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>extra</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mta_tax</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>tip_amount</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>tolls_amount</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>improvement_surcharge</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>total_amount</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>congestion_surcharge</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                       Missing values\n",
       "VendorID                            0\n",
       "tpep_pickup_datetime                0\n",
       "tpep_dropoff_datetime               0\n",
       "passenger_count                     0\n",
       "trip_distance                       0\n",
       "RatecodeID                          0\n",
       "store_and_fwd_flag                  0\n",
       "PULocationID                        0\n",
       "DOLocationID                        0\n",
       "payment_type                        0\n",
       "fare_amount                         0\n",
       "extra                               0\n",
       "mta_tax                             0\n",
       "tip_amount                          0\n",
       "tolls_amount                        0\n",
       "improvement_surcharge               0\n",
       "total_amount                        0\n",
       "congestion_surcharge                0"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nulls = df_train.isnull().sum().to_frame()# (to_frame():Convert Series to DataFrame),(sum():To sum the number of missing values),(isnull()to detect missing values)\n",
    "nulls.columns = [\"Missing values\"] \n",
    "nulls"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "106553f1",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_train.drop(['store_and_fwd_flag', 'PULocationID','DOLocationID','tpep_dropoff_datetime']\n",
    "         ,axis=1, inplace=True ) # delete two columns ,(axis=1:refers to column dimension)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "39eb590e",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_train['Day'] = pd.to_datetime(df_train['tpep_pickup_datetime']).dt.weekday"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "b1a1cd81",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>VendorID</th>\n",
       "      <th>tpep_pickup_datetime</th>\n",
       "      <th>passenger_count</th>\n",
       "      <th>trip_distance</th>\n",
       "      <th>RatecodeID</th>\n",
       "      <th>payment_type</th>\n",
       "      <th>fare_amount</th>\n",
       "      <th>extra</th>\n",
       "      <th>mta_tax</th>\n",
       "      <th>tip_amount</th>\n",
       "      <th>tolls_amount</th>\n",
       "      <th>improvement_surcharge</th>\n",
       "      <th>total_amount</th>\n",
       "      <th>congestion_surcharge</th>\n",
       "      <th>Day</th>\n",
       "      <th>Hour_pickup</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>964410</th>\n",
       "      <td>2.0</td>\n",
       "      <td>2021-03-17 23:23:57</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.92</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.5</td>\n",
       "      <td>1.50</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.3</td>\n",
       "      <td>12.30</td>\n",
       "      <td>2.5</td>\n",
       "      <td>2</td>\n",
       "      <td>23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1602218</th>\n",
       "      <td>1.0</td>\n",
       "      <td>2021-03-28 15:28:23</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1.10</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.5</td>\n",
       "      <td>0.5</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.3</td>\n",
       "      <td>10.30</td>\n",
       "      <td>2.5</td>\n",
       "      <td>6</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1502881</th>\n",
       "      <td>2.0</td>\n",
       "      <td>2021-03-26 19:42:37</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.19</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>13.5</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.3</td>\n",
       "      <td>17.80</td>\n",
       "      <td>2.5</td>\n",
       "      <td>4</td>\n",
       "      <td>19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570508</th>\n",
       "      <td>2.0</td>\n",
       "      <td>2021-03-11 12:16:29</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.02</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2.86</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.3</td>\n",
       "      <td>17.16</td>\n",
       "      <td>2.5</td>\n",
       "      <td>3</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1374167</th>\n",
       "      <td>2.0</td>\n",
       "      <td>2021-03-24 19:03:46</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.38</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>9.5</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2.76</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.3</td>\n",
       "      <td>16.56</td>\n",
       "      <td>2.5</td>\n",
       "      <td>2</td>\n",
       "      <td>19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1245787</th>\n",
       "      <td>2.0</td>\n",
       "      <td>2021-03-22 18:15:08</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.59</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>7.5</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.3</td>\n",
       "      <td>12.80</td>\n",
       "      <td>2.5</td>\n",
       "      <td>0</td>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1409311</th>\n",
       "      <td>1.0</td>\n",
       "      <td>2021-03-25 13:33:35</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6.70</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>22.5</td>\n",
       "      <td>2.5</td>\n",
       "      <td>0.5</td>\n",
       "      <td>5.15</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.3</td>\n",
       "      <td>30.95</td>\n",
       "      <td>2.5</td>\n",
       "      <td>3</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1092821</th>\n",
       "      <td>2.0</td>\n",
       "      <td>2021-03-19 20:19:08</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.27</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2.70</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.3</td>\n",
       "      <td>13.50</td>\n",
       "      <td>2.5</td>\n",
       "      <td>4</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1629764</th>\n",
       "      <td>1.0</td>\n",
       "      <td>2021-03-29 10:18:41</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.60</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>11.5</td>\n",
       "      <td>2.5</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.3</td>\n",
       "      <td>14.80</td>\n",
       "      <td>2.5</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>36587</th>\n",
       "      <td>2.0</td>\n",
       "      <td>2021-03-01 17:26:46</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.57</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.3</td>\n",
       "      <td>14.30</td>\n",
       "      <td>2.5</td>\n",
       "      <td>0</td>\n",
       "      <td>17</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1078366 rows × 16 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         VendorID tpep_pickup_datetime  passenger_count  trip_distance  \\\n",
       "964410        2.0  2021-03-17 23:23:57              1.0           1.92   \n",
       "1602218       1.0  2021-03-28 15:28:23              3.0           1.10   \n",
       "1502881       2.0  2021-03-26 19:42:37              1.0           2.19   \n",
       "570508        2.0  2021-03-11 12:16:29              1.0           2.02   \n",
       "1374167       2.0  2021-03-24 19:03:46              1.0           2.38   \n",
       "...           ...                  ...              ...            ...   \n",
       "1245787       2.0  2021-03-22 18:15:08              1.0           1.59   \n",
       "1409311       1.0  2021-03-25 13:33:35              1.0           6.70   \n",
       "1092821       2.0  2021-03-19 20:19:08              1.0           1.27   \n",
       "1629764       1.0  2021-03-29 10:18:41              1.0           2.60   \n",
       "36587         2.0  2021-03-01 17:26:46              2.0           1.57   \n",
       "\n",
       "         RatecodeID  payment_type  fare_amount  extra  mta_tax  tip_amount  \\\n",
       "964410          1.0           1.0          7.0    0.5      0.5        1.50   \n",
       "1602218         1.0           1.0          6.0    2.5      0.5        1.00   \n",
       "1502881         1.0           2.0         13.5    1.0      0.5        0.00   \n",
       "570508          1.0           1.0         11.0    0.0      0.5        2.86   \n",
       "1374167         1.0           1.0          9.5    1.0      0.5        2.76   \n",
       "...             ...           ...          ...    ...      ...         ...   \n",
       "1245787         1.0           1.0          7.5    1.0      0.5        1.00   \n",
       "1409311         1.0           1.0         22.5    2.5      0.5        5.15   \n",
       "1092821         1.0           1.0          7.0    0.5      0.5        2.70   \n",
       "1629764         1.0           2.0         11.5    2.5      0.5        0.00   \n",
       "36587           1.0           1.0          9.0    1.0      0.5        1.00   \n",
       "\n",
       "         tolls_amount  improvement_surcharge  total_amount  \\\n",
       "964410            0.0                    0.3         12.30   \n",
       "1602218           0.0                    0.3         10.30   \n",
       "1502881           0.0                    0.3         17.80   \n",
       "570508            0.0                    0.3         17.16   \n",
       "1374167           0.0                    0.3         16.56   \n",
       "...               ...                    ...           ...   \n",
       "1245787           0.0                    0.3         12.80   \n",
       "1409311           0.0                    0.3         30.95   \n",
       "1092821           0.0                    0.3         13.50   \n",
       "1629764           0.0                    0.3         14.80   \n",
       "36587             0.0                    0.3         14.30   \n",
       "\n",
       "         congestion_surcharge  Day  Hour_pickup  \n",
       "964410                    2.5    2           23  \n",
       "1602218                   2.5    6           15  \n",
       "1502881                   2.5    4           19  \n",
       "570508                    2.5    3           12  \n",
       "1374167                   2.5    2           19  \n",
       "...                       ...  ...          ...  \n",
       "1245787                   2.5    0           18  \n",
       "1409311                   2.5    3           13  \n",
       "1092821                   2.5    4           20  \n",
       "1629764                   2.5    0           10  \n",
       "36587                     2.5    0           17  \n",
       "\n",
       "[1078366 rows x 16 columns]"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_train['Hour_pickup'] = pd.to_datetime(df_train['tpep_pickup_datetime']).dt.hour\n",
    "df_train"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "2602ebd4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Hour_pickup  Day\n",
       "17           2      15170\n",
       "18           2      15054\n",
       "15           2      14600\n",
       "14           2      14273\n",
       "17           1      13907\n",
       "                    ...  \n",
       "3            4        197\n",
       "             1        195\n",
       "4            4        188\n",
       "3            3        176\n",
       "4            3        160\n",
       "Name: Day, Length: 168, dtype: int64"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Day_hours = df_train.groupby('Hour_pickup').Day.value_counts().sort_values(ascending=False)\n",
    "Day_hours"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "a7969216",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>VendorID</th>\n",
       "      <th>tpep_pickup_datetime</th>\n",
       "      <th>passenger_count</th>\n",
       "      <th>trip_distance</th>\n",
       "      <th>RatecodeID</th>\n",
       "      <th>payment_type</th>\n",
       "      <th>fare_amount</th>\n",
       "      <th>extra</th>\n",
       "      <th>mta_tax</th>\n",
       "      <th>tip_amount</th>\n",
       "      <th>tolls_amount</th>\n",
       "      <th>improvement_surcharge</th>\n",
       "      <th>total_amount</th>\n",
       "      <th>congestion_surcharge</th>\n",
       "      <th>Day</th>\n",
       "      <th>Hour_pickup</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>964410</th>\n",
       "      <td>2.0</td>\n",
       "      <td>2021-03-17 23:23:57</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.92</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.5</td>\n",
       "      <td>1.50</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.3</td>\n",
       "      <td>12.30</td>\n",
       "      <td>2.5</td>\n",
       "      <td>2</td>\n",
       "      <td>23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1602218</th>\n",
       "      <td>1.0</td>\n",
       "      <td>2021-03-28 15:28:23</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1.10</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.5</td>\n",
       "      <td>0.5</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.3</td>\n",
       "      <td>10.30</td>\n",
       "      <td>2.5</td>\n",
       "      <td>6</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1502881</th>\n",
       "      <td>2.0</td>\n",
       "      <td>2021-03-26 19:42:37</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.19</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>13.5</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.3</td>\n",
       "      <td>17.80</td>\n",
       "      <td>2.5</td>\n",
       "      <td>4</td>\n",
       "      <td>19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>570508</th>\n",
       "      <td>2.0</td>\n",
       "      <td>2021-03-11 12:16:29</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.02</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2.86</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.3</td>\n",
       "      <td>17.16</td>\n",
       "      <td>2.5</td>\n",
       "      <td>3</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1374167</th>\n",
       "      <td>2.0</td>\n",
       "      <td>2021-03-24 19:03:46</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.38</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>9.5</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2.76</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.3</td>\n",
       "      <td>16.56</td>\n",
       "      <td>2.5</td>\n",
       "      <td>2</td>\n",
       "      <td>19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1245787</th>\n",
       "      <td>2.0</td>\n",
       "      <td>2021-03-22 18:15:08</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.59</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>7.5</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.3</td>\n",
       "      <td>12.80</td>\n",
       "      <td>2.5</td>\n",
       "      <td>0</td>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1409311</th>\n",
       "      <td>1.0</td>\n",
       "      <td>2021-03-25 13:33:35</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6.70</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>22.5</td>\n",
       "      <td>2.5</td>\n",
       "      <td>0.5</td>\n",
       "      <td>5.15</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.3</td>\n",
       "      <td>30.95</td>\n",
       "      <td>2.5</td>\n",
       "      <td>3</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1092821</th>\n",
       "      <td>2.0</td>\n",
       "      <td>2021-03-19 20:19:08</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.27</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.5</td>\n",
       "      <td>2.70</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.3</td>\n",
       "      <td>13.50</td>\n",
       "      <td>2.5</td>\n",
       "      <td>4</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1629764</th>\n",
       "      <td>1.0</td>\n",
       "      <td>2021-03-29 10:18:41</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.60</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>11.5</td>\n",
       "      <td>2.5</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.3</td>\n",
       "      <td>14.80</td>\n",
       "      <td>2.5</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>36587</th>\n",
       "      <td>2.0</td>\n",
       "      <td>2021-03-01 17:26:46</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.57</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.3</td>\n",
       "      <td>14.30</td>\n",
       "      <td>2.5</td>\n",
       "      <td>0</td>\n",
       "      <td>17</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1078366 rows × 16 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         VendorID tpep_pickup_datetime  passenger_count  trip_distance  \\\n",
       "964410        2.0  2021-03-17 23:23:57              1.0           1.92   \n",
       "1602218       1.0  2021-03-28 15:28:23              3.0           1.10   \n",
       "1502881       2.0  2021-03-26 19:42:37              1.0           2.19   \n",
       "570508        2.0  2021-03-11 12:16:29              1.0           2.02   \n",
       "1374167       2.0  2021-03-24 19:03:46              1.0           2.38   \n",
       "...           ...                  ...              ...            ...   \n",
       "1245787       2.0  2021-03-22 18:15:08              1.0           1.59   \n",
       "1409311       1.0  2021-03-25 13:33:35              1.0           6.70   \n",
       "1092821       2.0  2021-03-19 20:19:08              1.0           1.27   \n",
       "1629764       1.0  2021-03-29 10:18:41              1.0           2.60   \n",
       "36587         2.0  2021-03-01 17:26:46              2.0           1.57   \n",
       "\n",
       "         RatecodeID  payment_type  fare_amount  extra  mta_tax  tip_amount  \\\n",
       "964410          1.0           1.0          7.0    0.5      0.5        1.50   \n",
       "1602218         1.0           1.0          6.0    2.5      0.5        1.00   \n",
       "1502881         1.0           2.0         13.5    1.0      0.5        0.00   \n",
       "570508          1.0           1.0         11.0    0.0      0.5        2.86   \n",
       "1374167         1.0           1.0          9.5    1.0      0.5        2.76   \n",
       "...             ...           ...          ...    ...      ...         ...   \n",
       "1245787         1.0           1.0          7.5    1.0      0.5        1.00   \n",
       "1409311         1.0           1.0         22.5    2.5      0.5        5.15   \n",
       "1092821         1.0           1.0          7.0    0.5      0.5        2.70   \n",
       "1629764         1.0           2.0         11.5    2.5      0.5        0.00   \n",
       "36587           1.0           1.0          9.0    1.0      0.5        1.00   \n",
       "\n",
       "         tolls_amount  improvement_surcharge  total_amount  \\\n",
       "964410            0.0                    0.3         12.30   \n",
       "1602218           0.0                    0.3         10.30   \n",
       "1502881           0.0                    0.3         17.80   \n",
       "570508            0.0                    0.3         17.16   \n",
       "1374167           0.0                    0.3         16.56   \n",
       "...               ...                    ...           ...   \n",
       "1245787           0.0                    0.3         12.80   \n",
       "1409311           0.0                    0.3         30.95   \n",
       "1092821           0.0                    0.3         13.50   \n",
       "1629764           0.0                    0.3         14.80   \n",
       "36587             0.0                    0.3         14.30   \n",
       "\n",
       "         congestion_surcharge  Day  Hour_pickup  \n",
       "964410                    2.5    2           23  \n",
       "1602218                   2.5    6           15  \n",
       "1502881                   2.5    4           19  \n",
       "570508                    2.5    3           12  \n",
       "1374167                   2.5    2           19  \n",
       "...                       ...  ...          ...  \n",
       "1245787                   2.5    0           18  \n",
       "1409311                   2.5    3           13  \n",
       "1092821                   2.5    4           20  \n",
       "1629764                   2.5    0           10  \n",
       "36587                     2.5    0           17  \n",
       "\n",
       "[1078366 rows x 16 columns]"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_train"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "c3e48625",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>VendorID</th>\n",
       "      <th>passenger_count</th>\n",
       "      <th>trip_distance</th>\n",
       "      <th>RatecodeID</th>\n",
       "      <th>payment_type</th>\n",
       "      <th>fare_amount</th>\n",
       "      <th>extra</th>\n",
       "      <th>mta_tax</th>\n",
       "      <th>tip_amount</th>\n",
       "      <th>tolls_amount</th>\n",
       "      <th>improvement_surcharge</th>\n",
       "      <th>total_amount</th>\n",
       "      <th>congestion_surcharge</th>\n",
       "      <th>Day</th>\n",
       "      <th>Hour_pickup</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>VendorID</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.182813</td>\n",
       "      <td>0.022184</td>\n",
       "      <td>0.002992</td>\n",
       "      <td>-0.019853</td>\n",
       "      <td>-0.001468</td>\n",
       "      <td>-0.864191</td>\n",
       "      <td>-0.035571</td>\n",
       "      <td>0.020458</td>\n",
       "      <td>-0.001345</td>\n",
       "      <td>-0.048582</td>\n",
       "      <td>-0.001365</td>\n",
       "      <td>0.002921</td>\n",
       "      <td>0.002457</td>\n",
       "      <td>0.004314</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>passenger_count</th>\n",
       "      <td>0.182813</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.014978</td>\n",
       "      <td>-0.004230</td>\n",
       "      <td>-0.002759</td>\n",
       "      <td>-0.000137</td>\n",
       "      <td>-0.153117</td>\n",
       "      <td>0.008834</td>\n",
       "      <td>0.006187</td>\n",
       "      <td>0.005918</td>\n",
       "      <td>0.006325</td>\n",
       "      <td>-0.000052</td>\n",
       "      <td>0.006639</td>\n",
       "      <td>0.022087</td>\n",
       "      <td>0.025180</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>trip_distance</th>\n",
       "      <td>0.022184</td>\n",
       "      <td>0.014978</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.131053</td>\n",
       "      <td>-0.002745</td>\n",
       "      <td>0.021792</td>\n",
       "      <td>-0.018104</td>\n",
       "      <td>-0.007807</td>\n",
       "      <td>0.386609</td>\n",
       "      <td>0.487434</td>\n",
       "      <td>0.019845</td>\n",
       "      <td>0.025323</td>\n",
       "      <td>-0.177165</td>\n",
       "      <td>0.025378</td>\n",
       "      <td>0.022257</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>RatecodeID</th>\n",
       "      <td>0.002992</td>\n",
       "      <td>-0.004230</td>\n",
       "      <td>0.131053</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.008350</td>\n",
       "      <td>0.005260</td>\n",
       "      <td>-0.023576</td>\n",
       "      <td>-0.144581</td>\n",
       "      <td>0.094852</td>\n",
       "      <td>0.137733</td>\n",
       "      <td>-0.022802</td>\n",
       "      <td>0.006031</td>\n",
       "      <td>-0.093452</td>\n",
       "      <td>0.007312</td>\n",
       "      <td>-0.000357</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>payment_type</th>\n",
       "      <td>-0.019853</td>\n",
       "      <td>-0.002759</td>\n",
       "      <td>-0.002745</td>\n",
       "      <td>0.008350</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.002171</td>\n",
       "      <td>-0.030952</td>\n",
       "      <td>-0.283053</td>\n",
       "      <td>-0.476788</td>\n",
       "      <td>-0.012969</td>\n",
       "      <td>-0.305737</td>\n",
       "      <td>-0.001407</td>\n",
       "      <td>-0.247032</td>\n",
       "      <td>-0.013424</td>\n",
       "      <td>-0.040951</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fare_amount</th>\n",
       "      <td>-0.001468</td>\n",
       "      <td>-0.000137</td>\n",
       "      <td>0.021792</td>\n",
       "      <td>0.005260</td>\n",
       "      <td>0.002171</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000650</td>\n",
       "      <td>-0.000498</td>\n",
       "      <td>0.009872</td>\n",
       "      <td>0.012824</td>\n",
       "      <td>-0.002648</td>\n",
       "      <td>0.999968</td>\n",
       "      <td>-0.003907</td>\n",
       "      <td>0.000644</td>\n",
       "      <td>-0.000102</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>extra</th>\n",
       "      <td>-0.864191</td>\n",
       "      <td>-0.153117</td>\n",
       "      <td>-0.018104</td>\n",
       "      <td>-0.023576</td>\n",
       "      <td>-0.030952</td>\n",
       "      <td>0.000650</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.086307</td>\n",
       "      <td>0.020665</td>\n",
       "      <td>-0.010052</td>\n",
       "      <td>0.081750</td>\n",
       "      <td>0.001618</td>\n",
       "      <td>0.198445</td>\n",
       "      <td>-0.055777</td>\n",
       "      <td>0.170583</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mta_tax</th>\n",
       "      <td>-0.035571</td>\n",
       "      <td>0.008834</td>\n",
       "      <td>-0.007807</td>\n",
       "      <td>-0.144581</td>\n",
       "      <td>-0.283053</td>\n",
       "      <td>-0.000498</td>\n",
       "      <td>0.086307</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.025427</td>\n",
       "      <td>-0.052684</td>\n",
       "      <td>0.918469</td>\n",
       "      <td>0.000782</td>\n",
       "      <td>0.432095</td>\n",
       "      <td>-0.004895</td>\n",
       "      <td>0.000984</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>tip_amount</th>\n",
       "      <td>0.020458</td>\n",
       "      <td>0.006187</td>\n",
       "      <td>0.386609</td>\n",
       "      <td>0.094852</td>\n",
       "      <td>-0.476788</td>\n",
       "      <td>0.009872</td>\n",
       "      <td>0.020665</td>\n",
       "      <td>0.025427</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.279425</td>\n",
       "      <td>0.062731</td>\n",
       "      <td>0.016953</td>\n",
       "      <td>0.047558</td>\n",
       "      <td>0.018938</td>\n",
       "      <td>0.042744</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>tolls_amount</th>\n",
       "      <td>-0.001345</td>\n",
       "      <td>0.005918</td>\n",
       "      <td>0.487434</td>\n",
       "      <td>0.137733</td>\n",
       "      <td>-0.012969</td>\n",
       "      <td>0.012824</td>\n",
       "      <td>-0.010052</td>\n",
       "      <td>-0.052684</td>\n",
       "      <td>0.279425</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.018970</td>\n",
       "      <td>0.017304</td>\n",
       "      <td>-0.127172</td>\n",
       "      <td>0.011120</td>\n",
       "      <td>0.006269</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>improvement_surcharge</th>\n",
       "      <td>-0.048582</td>\n",
       "      <td>0.006325</td>\n",
       "      <td>0.019845</td>\n",
       "      <td>-0.022802</td>\n",
       "      <td>-0.305737</td>\n",
       "      <td>-0.002648</td>\n",
       "      <td>0.081750</td>\n",
       "      <td>0.918469</td>\n",
       "      <td>0.062731</td>\n",
       "      <td>0.018970</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.000973</td>\n",
       "      <td>0.414449</td>\n",
       "      <td>-0.000562</td>\n",
       "      <td>-0.000132</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>total_amount</th>\n",
       "      <td>-0.001365</td>\n",
       "      <td>-0.000052</td>\n",
       "      <td>0.025323</td>\n",
       "      <td>0.006031</td>\n",
       "      <td>-0.001407</td>\n",
       "      <td>0.999968</td>\n",
       "      <td>0.001618</td>\n",
       "      <td>0.000782</td>\n",
       "      <td>0.016953</td>\n",
       "      <td>0.017304</td>\n",
       "      <td>-0.000973</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.001833</td>\n",
       "      <td>0.000607</td>\n",
       "      <td>0.000743</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>congestion_surcharge</th>\n",
       "      <td>0.002921</td>\n",
       "      <td>0.006639</td>\n",
       "      <td>-0.177165</td>\n",
       "      <td>-0.093452</td>\n",
       "      <td>-0.247032</td>\n",
       "      <td>-0.003907</td>\n",
       "      <td>0.198445</td>\n",
       "      <td>0.432095</td>\n",
       "      <td>0.047558</td>\n",
       "      <td>-0.127172</td>\n",
       "      <td>0.414449</td>\n",
       "      <td>-0.001833</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.005922</td>\n",
       "      <td>0.004032</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Day</th>\n",
       "      <td>0.002457</td>\n",
       "      <td>0.022087</td>\n",
       "      <td>0.025378</td>\n",
       "      <td>0.007312</td>\n",
       "      <td>-0.013424</td>\n",
       "      <td>0.000644</td>\n",
       "      <td>-0.055777</td>\n",
       "      <td>-0.004895</td>\n",
       "      <td>0.018938</td>\n",
       "      <td>0.011120</td>\n",
       "      <td>-0.000562</td>\n",
       "      <td>0.000607</td>\n",
       "      <td>-0.005922</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.054538</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Hour_pickup</th>\n",
       "      <td>0.004314</td>\n",
       "      <td>0.025180</td>\n",
       "      <td>0.022257</td>\n",
       "      <td>-0.000357</td>\n",
       "      <td>-0.040951</td>\n",
       "      <td>-0.000102</td>\n",
       "      <td>0.170583</td>\n",
       "      <td>0.000984</td>\n",
       "      <td>0.042744</td>\n",
       "      <td>0.006269</td>\n",
       "      <td>-0.000132</td>\n",
       "      <td>0.000743</td>\n",
       "      <td>0.004032</td>\n",
       "      <td>0.054538</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                       VendorID  passenger_count  trip_distance  RatecodeID  \\\n",
       "VendorID               1.000000         0.182813       0.022184    0.002992   \n",
       "passenger_count        0.182813         1.000000       0.014978   -0.004230   \n",
       "trip_distance          0.022184         0.014978       1.000000    0.131053   \n",
       "RatecodeID             0.002992        -0.004230       0.131053    1.000000   \n",
       "payment_type          -0.019853        -0.002759      -0.002745    0.008350   \n",
       "fare_amount           -0.001468        -0.000137       0.021792    0.005260   \n",
       "extra                 -0.864191        -0.153117      -0.018104   -0.023576   \n",
       "mta_tax               -0.035571         0.008834      -0.007807   -0.144581   \n",
       "tip_amount             0.020458         0.006187       0.386609    0.094852   \n",
       "tolls_amount          -0.001345         0.005918       0.487434    0.137733   \n",
       "improvement_surcharge -0.048582         0.006325       0.019845   -0.022802   \n",
       "total_amount          -0.001365        -0.000052       0.025323    0.006031   \n",
       "congestion_surcharge   0.002921         0.006639      -0.177165   -0.093452   \n",
       "Day                    0.002457         0.022087       0.025378    0.007312   \n",
       "Hour_pickup            0.004314         0.025180       0.022257   -0.000357   \n",
       "\n",
       "                       payment_type  fare_amount     extra   mta_tax  \\\n",
       "VendorID                  -0.019853    -0.001468 -0.864191 -0.035571   \n",
       "passenger_count           -0.002759    -0.000137 -0.153117  0.008834   \n",
       "trip_distance             -0.002745     0.021792 -0.018104 -0.007807   \n",
       "RatecodeID                 0.008350     0.005260 -0.023576 -0.144581   \n",
       "payment_type               1.000000     0.002171 -0.030952 -0.283053   \n",
       "fare_amount                0.002171     1.000000  0.000650 -0.000498   \n",
       "extra                     -0.030952     0.000650  1.000000  0.086307   \n",
       "mta_tax                   -0.283053    -0.000498  0.086307  1.000000   \n",
       "tip_amount                -0.476788     0.009872  0.020665  0.025427   \n",
       "tolls_amount              -0.012969     0.012824 -0.010052 -0.052684   \n",
       "improvement_surcharge     -0.305737    -0.002648  0.081750  0.918469   \n",
       "total_amount              -0.001407     0.999968  0.001618  0.000782   \n",
       "congestion_surcharge      -0.247032    -0.003907  0.198445  0.432095   \n",
       "Day                       -0.013424     0.000644 -0.055777 -0.004895   \n",
       "Hour_pickup               -0.040951    -0.000102  0.170583  0.000984   \n",
       "\n",
       "                       tip_amount  tolls_amount  improvement_surcharge  \\\n",
       "VendorID                 0.020458     -0.001345              -0.048582   \n",
       "passenger_count          0.006187      0.005918               0.006325   \n",
       "trip_distance            0.386609      0.487434               0.019845   \n",
       "RatecodeID               0.094852      0.137733              -0.022802   \n",
       "payment_type            -0.476788     -0.012969              -0.305737   \n",
       "fare_amount              0.009872      0.012824              -0.002648   \n",
       "extra                    0.020665     -0.010052               0.081750   \n",
       "mta_tax                  0.025427     -0.052684               0.918469   \n",
       "tip_amount               1.000000      0.279425               0.062731   \n",
       "tolls_amount             0.279425      1.000000               0.018970   \n",
       "improvement_surcharge    0.062731      0.018970               1.000000   \n",
       "total_amount             0.016953      0.017304              -0.000973   \n",
       "congestion_surcharge     0.047558     -0.127172               0.414449   \n",
       "Day                      0.018938      0.011120              -0.000562   \n",
       "Hour_pickup              0.042744      0.006269              -0.000132   \n",
       "\n",
       "                       total_amount  congestion_surcharge       Day  \\\n",
       "VendorID                  -0.001365              0.002921  0.002457   \n",
       "passenger_count           -0.000052              0.006639  0.022087   \n",
       "trip_distance              0.025323             -0.177165  0.025378   \n",
       "RatecodeID                 0.006031             -0.093452  0.007312   \n",
       "payment_type              -0.001407             -0.247032 -0.013424   \n",
       "fare_amount                0.999968             -0.003907  0.000644   \n",
       "extra                      0.001618              0.198445 -0.055777   \n",
       "mta_tax                    0.000782              0.432095 -0.004895   \n",
       "tip_amount                 0.016953              0.047558  0.018938   \n",
       "tolls_amount               0.017304             -0.127172  0.011120   \n",
       "improvement_surcharge     -0.000973              0.414449 -0.000562   \n",
       "total_amount               1.000000             -0.001833  0.000607   \n",
       "congestion_surcharge      -0.001833              1.000000 -0.005922   \n",
       "Day                        0.000607             -0.005922  1.000000   \n",
       "Hour_pickup                0.000743              0.004032  0.054538   \n",
       "\n",
       "                       Hour_pickup  \n",
       "VendorID                  0.004314  \n",
       "passenger_count           0.025180  \n",
       "trip_distance             0.022257  \n",
       "RatecodeID               -0.000357  \n",
       "payment_type             -0.040951  \n",
       "fare_amount              -0.000102  \n",
       "extra                     0.170583  \n",
       "mta_tax                   0.000984  \n",
       "tip_amount                0.042744  \n",
       "tolls_amount              0.006269  \n",
       "improvement_surcharge    -0.000132  \n",
       "total_amount              0.000743  \n",
       "congestion_surcharge      0.004032  \n",
       "Day                       0.054538  \n",
       "Hour_pickup               1.000000  "
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_train.corr()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "4b754a2f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "964410     2.0\n",
       "1602218    1.0\n",
       "1502881    2.0\n",
       "570508     2.0\n",
       "1374167    2.0\n",
       "          ... \n",
       "1245787    2.0\n",
       "1409311    1.0\n",
       "1092821    2.0\n",
       "1629764    1.0\n",
       "36587      2.0\n",
       "Name: VendorID, Length: 1078366, dtype: object"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_train['VendorID'] = df_train.astype(str)\n",
    "df_train['VendorID']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "357f73d0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "964410     2.0\n",
       "1602218    1.0\n",
       "1502881    2.0\n",
       "570508     2.0\n",
       "1374167    2.0\n",
       "          ... \n",
       "1245787    2.0\n",
       "1409311    1.0\n",
       "1092821    2.0\n",
       "1629764    1.0\n",
       "36587      2.0\n",
       "Name: RatecodeID, Length: 1078366, dtype: object"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_train['RatecodeID'] = df_train.astype(str)\n",
    "df_train['RatecodeID']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "1f4c0c42",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "964410     2.0\n",
       "1602218    1.0\n",
       "1502881    2.0\n",
       "570508     2.0\n",
       "1374167    2.0\n",
       "          ... \n",
       "1245787    2.0\n",
       "1409311    1.0\n",
       "1092821    2.0\n",
       "1629764    1.0\n",
       "36587      2.0\n",
       "Name: payment_type, Length: 1078366, dtype: object"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_train['payment_type'] = df_train.astype(str)\n",
    "df_train['payment_type']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "04ec2d07",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_dummies_train = pd.get_dummies(data=df_train)\n",
    "df_dummies_train.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9a72012b",
   "metadata": {},
   "outputs": [],
   "source": [
    "sns.pairplot(df_train);"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "645c78ee",
   "metadata": {},
   "outputs": [],
   "source": [
    "plt.figure(figsize = [15,15])\n",
    "sns.heatmap(df_train1.corr(), cmap=\"seismic\", annot=True, vmin=-1, vmax=1);"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "67e87e0c",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "99fdc8f9",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b04d04e2",
   "metadata": {},
   "outputs": [],
   "source": [
    "df1.drop(['store_and_fwd_flag', 'PULocationID','DOLocationID'],axis=1, inplace=True ) # delete two columns ,(axis=1:refers to column dimension)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
